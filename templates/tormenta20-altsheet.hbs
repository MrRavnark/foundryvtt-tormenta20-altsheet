<form class="t20as-sheet {{cssClass}} {{actor.system.activeThemeClass}}" autocomplete="off">
    {{!-- Sheet Header --}}
    <header class="sheet-header">
        <div class="header-section header-top">
            <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" />
            <div class="header-details">
                <h1 class="charname"><input name="name" type="text" value="{{actor.name}}" placeholder="Nome do Personagem"/></h1>
                <div class="summary-details">
                    <input type="text" name="system.details.raca.value" value="{{detalhes.raca}}" placeholder="Raça"/>
                    <input type="text" name="system.details.origem.value" value="{{detalhes.origem}}" placeholder="Origem"/>
                    <input type="text" name="system.details.classe.value" value="{{detalhes.classe}}" placeholder="Classe"/>
                </div>
            </div>
        </div>

        <div class="header-section header-attributes">
            {{!-- PV, PM, Defesa --}}
            <div class="attribute-box pv-pm">
                <label>PV</label>
                <input type="number" name="system.attributes.pv.value" value="{{atributos.pv.value}}" placeholder="0"/>
                <span>/</span>
                <input type="number" name="system.attributes.pv.max" value="{{atributos.pv.max}}" placeholder="0"/>
            </div>
             <div class="attribute-box pv-pm">
                <label>PM</label>
                <input type="number" name="system.attributes.pm.value" value="{{atributos.pm.value}}" placeholder="0"/>
                <span>/</span>
                <input type="number" name="system.attributes.pm.max" value="{{atributos.pm.max}}" placeholder="0"/>
            </div>
            <div class="attribute-box defense">
                <label>Defesa</label>
                <input type="number" name="system.attributes.defesa.value" value="{{atributos.defesa.value}}" placeholder="0"/>
            </div>

            {{!-- Atributos FOR, DES, CON, INT, SAB, CAR --}}
            {{!-- Iterando sobre os atributos puxados do getData() para exibir valor base e modificador --}}
            {{#each T20.atributos as |attrDef key|}} {{!-- Itera sobre a definição T20.atributos --}}
            <div class="attribute-box simple-attribute">
                <label>{{localize attrDef}}</label> {{!-- Ex: Força, Destreza --}}
                <input type="number" name="system.attributes.{{key}}.value" value="{{atributos.[key].value}}" placeholder="0"/>
                <span class="attribute-mod">{{atributos.[key].mod}}</span> {{!-- Ex: +0, -1 --}}
            </div>
            {{/each}}
        </div>
    </header>

    {{!-- Sheet Body --}}
    <section class="sheet-body">
        <nav class="sheet-tabs tabs" data-group="primary">
            <a class="item active" data-tab="detalhes">{{ localize "T20AS.CharacterSheetLabelDark" }}</a>
            <a class="item" data-tab="inventario">{{ localize "PF1.Inventory" }}</a> {{!-- Mantido PF1.Inventory por enquanto --}}
            <a class="item" data-tab="poderes">Poderes</a>
            <a class="item" data-tab="caracteristicas">Características</a> {{!-- Nova aba para características --}}
            <a class="item" data-tab="proficiencias">Proficiências</a> {{!-- Nova aba para proficiências --}}
        </nav>

        {{!-- Conteúdo das Abas --}}
        <div class="tab" data-group="primary" data-tab="detalhes">
            <h2>Detalhes do Personagem</h2>
            <p>O ID da ficha é: <strong>{{this.options.id}}</strong></p>
            <p>Classe do Tema Ativo: <strong>{{actor.system.activeThemeClass}}</strong></p>

            <h3>Perícias:</h3>
            <ul class="skills-list">
                {{!-- Iterando sobre as perícias puxadas do getData() --}}
                {{#each T20.pericias as |periciaDef id|}} {{!-- Itera sobre a definição T20.pericias --}}
                <li class="skill-item">
                    <label>{{localize periciaDef.label}}:</label> {{!-- Agora usa o label traduzido da perícia --}}
                    <input type="number" name="system.skills.{{id}}.value" value="{{pericias.[id].value}}" placeholder="0"/>
                    (Mod: <span class="skill-mod">{{pericias.[id].mod}}</span> | Bônus: <span class="skill-bonus">{{pericias.[id].bonus}}</span>)
                </li>
                {{/each}}
            </ul>
        </div>

        <div class="tab" data-group="primary" data-tab="inventario">
            <h2>Inventário</h2>
            <p>Esta é a aba de inventário.</p>
            <p>Aqui você listará seus equipamentos, armas e itens.</p>
        </div>

        <div class="tab" data-group="primary" data-tab="poderes">
            <h2>Poderes e Habilidades</h2>
            <p>Esta é a aba de poderes.</p>
            <p>Aqui você listará seus talentos, magias e habilidades de classe/raça.</p>
        </div>

        {{!-- Nova Aba: Características --}}
        <div class="tab" data-group="primary" data-tab="caracteristicas">
            <h2>Outras Características</h2>
            <p>Tamanho: <input type="text" name="system.details.tamanho.value" value="{{caracteristicas.tamanho}}" placeholder="Médio"/></p>
            <p>Deslocamento: <input type="text" name="system.attributes.deslocamento.value" value="{{caracteristicas.deslocamento}}" placeholder="9m"/></p>

            <h3>Resistências:</h3>
            <ul class="resistance-list">
                {{#each T20.resistencias as |resistenciaDef id|}}
                <li><label>{{localize resistenciaDef}}:</label> {{caracteristicas.resistencias.[id].value}}</li>
                {{/each}}
            </ul>
            <h3>Imunidades:</h3>
            <ul class="immunity-list">
                {{#each caracteristicas.imunidades as |imunidade id|}}
                <li><label>{{localize imunidade.label}}:</label> {{imunidade.value}}</li>
                {{/each}}
            </ul>
            <h3>Sentidos:</h3>
            <ul class="senses-list">
                {{#each caracteristicas.sentidos as |sentido id|}}
                <li><label>{{localize sentido.label}}</label></li>
                {{/each}}
            </ul>
        </div>

        {{!-- Nova Aba: Proficiências --}}
        <div class="tab" data-group="primary" data-tab="proficiencias">
            <h2>Proficiências</h2>
            <h3>Armas:</h3>
            <ul class="prof-weapons-list">
                {{#each T20.profArmas as |armaDef id|}}
                {{#if proficiencias.armas.[id].value}} {{!-- Só mostra se for proficiente --}}
                <li><label>{{localize armaDef}}</label></li>
                {{/if}}
                {{/each}}
            </ul>
            <h3>Armaduras:</h3>
            <ul class="prof-armor-list">
                {{#each T20.profArmaduras as |armaduraDef id|}}
                {{#if proficiencias.armaduras.[id].value}} {{!-- Só mostra se for proficiente --}}
                <li><label>{{localize armaduraDef}}</label></li>
                {{/if}}
                {{/each}}
            </ul>
        </div>
    </section>
</form>